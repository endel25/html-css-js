<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>ENDEL DIGITAL</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" type="image/x-icon" href="favicon.png" />
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
        <link rel="stylesheet" type="text/css" media="screen" href="assets/css/perfect-scrollbar.min.css" />
        <link rel="stylesheet" type="text/css" media="screen" href="assets/css/style.css" />
        <link defer rel="stylesheet" type="text/css" media="screen" href="assets/css/animate.css" />
        <link rel="stylesheet" href="assets/css/vms _css/index.css" />
    </head>

    <body
        x-data="main"
        class="relative overflow-x-hidden font-nunito text-sm font-normal antialiased"
        :class="[ $store.app.sidebar ? 'toggle-sidebar' : '', $store.app.theme === 'dark' || $store.app.isDarkMode ?  'dark' : '', $store.app.menu, $store.app.layout,$store.app.rtlClass]"
    >
        <!-- sidebar menu overlay -->
        <div id="sidebar-menu-overlay-container"></div>

        <!-- screen loader -->
        <div id="screen-loader-container"></div>

        <!-- scroll to top button -->
        <div id="scroll-to-topdown-container"></div>

        <!-- Create Gatepass sticky button -->
        <a href="Spot.html">
            <div class="sticky-button" id="sticky-button">
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="white"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                >
                    <line x1="12" y1="5" x2="12" y2="19"></line>
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
                <span>Create Visitor Gatepass</span>
            </div>
        </a>

        <!-- start theme customizer section -->
        <div id="theme-customizer-container"></div>
        <!-- end theme customizer section -->

        <div class="main-container min-h-screen text-black dark:text-white-dark" :class="[$store.app.navbar]">
            <!-- start sidebar section -->
            <div id="sidebar-container"></div>
            <!-- end sidebar section -->

            <div class="main-content flex min-h-screen flex-col">
                <!-- start header section -->
                <div id="header-container"></div>
                <!-- end header section -->

                <div class="dvanimation animate__animated flex-grow" :class="[$store.app.animation]">
                    <!-- start main content section -->
                    <div x-data="sales" class="p-6">
                        <!--start main content-->
                        <div class="mb-6 grid grid-cols-1 gap-6 text-white sm:grid-cols-2 xl:grid-cols-4">
                            <div
                                class="panel max-w-md mx-auto bg-gradient-to-r from-blue-500 to-cyan-400 p-6 rounded-lg shadow-lg card"
                                onclick="window.location.href='SpotEntry.html'"
                            >
                                <div class="flex">
                                    <!-- Left Column -->
                                    <div class="w-2/3">
                                        <div class="text-md font-semibold text-white">Total Visitors</div>
                                        <div class="mt-5 flex items-center">
                                            <div class="text-3xl font-bold text-white ltr:mr-3 rtl:ml-3" id="totalVisitorsCount">0</div>
                                        </div>
                                        <div class="mt-5 flex items-center font-semibold text-white">
                                            <svg
                                                width="24"
                                                height="24"
                                                viewBox="0 0 24 24"
                                                fill="none"
                                                xmlns="http://www.w3.org/2000/svg"
                                                class="h-5 w-5 shrink-0 ltr:mr-2 rtl:ml-2"
                                            >
                                                <path
                                                    opacity="0.5"
                                                    d="M3.27489 15.2957C2.42496 14.1915 2 13.6394 2 12C2 10.3606 2.42496 9.80853 3.27489 8.70433C4.97196 6.49956 7.81811 4 12 4C16.1819 4 19.028 6.49956 20.7251 8.70433C21.575 9.80853 22 10.3606 22 12C22 13.6394 21.575 14.1915 20.7251 15.2957C19.028 17.5004 16.1819 20 12 20C7.81811 20 4.97196 17.5004 3.27489 15.2957Z"
                                                    stroke="currentColor"
                                                    stroke-width="1.5"
                                                ></path>
                                                <path
                                                    d="M15 12C15 13.6569 13.6569 15 12 15C10.3431 15 9 13.6569 9 12C9 10.3431 10.3431 9 12 9C13.6569 9 15 10.3431 15 12Z"
                                                    stroke="currentColor"
                                                    stroke-width="1.5"
                                                ></path>
                                            </svg>
                                            Last Week <span id="lastWeekCount">0</span>
                                        </div>
                                    </div>
                                    <!-- Right Column -->
                                    <div class="w-1/3 flex items-end justify-end">
                                        <img src="assets/images/returning-visitor.png" alt="Logo" style="opacity: 0.5" />
                                    </div>
                                </div>
                            </div>

                            <!-- Approved Passes -->
                            <div
                                class="panel mx-auto bg-gradient-to-r from-violet-500 to-violet-400 p-6 rounded-lg shadow-lg card"
                                onclick="window.location.href='Approvedpasses.html'"
                            >
                                <div class="flex">
                                    <!-- Left Column -->
                                    <div class="w-2/3">
                                        <div class="text-md font-semibold text-white">Total Approved Passes</div>
                                        <div class="mt-5 flex items-center">
                                            <div class="text-3xl font-bold text-white ltr:mr-3 rtl:ml-3" id="approvedCount">0</div>
                                        </div>
                                        <div class="mt-5 flex items-center font-semibold text-white">
                                            <svg
                                                width="24"
                                                height="24"
                                                viewBox="0 0 24 24"
                                                fill="none"
                                                xmlns="http://www.w3.org/2000/svg"
                                                class="h-5 w-5 shrink-0 ltr:mr-2 rtl:ml-2"
                                            >
                                                <path
                                                    opacity="0.5"
                                                    d="M3.27489 15.2957C2.42496 14.1915 2 13.6394 2 12C2 10.3606 2.42496 9.80853 3.27489 8.70433C4.97196 6.49956 7.81811 4 12 4C16.1819 4 19.028 6.49956 20.7251 8.70433C21.575 9.80853 22 10.3606 22 12C22 13.6394 21.575 14.1915 20.7251 15.2957C19.028 17.5004 16.1819 20 12 20C7.81811 20 4.97196 17.5004 3.27489 15.2957Z"
                                                    stroke="currentColor"
                                                    stroke-width="1.5"
                                                ></path>
                                                <path
                                                    d="M15 12C15 13.6569 13.6569 15 12 15C10.3431 15 9 13.6569 9 12C9 10.3431 10.3431 9 12 9C13.6569 9 15 10.3431 15 12Z"
                                                    stroke="currentColor"
                                                    stroke-width="1.5"
                                                ></path>
                                            </svg>
                                            Last Week <span id="lastWeekCount">0</span>
                                        </div>
                                    </div>
                                    <!-- Right Column -->
                                    <div class="w-1/3 flex items-end justify-end">
                                        <img src="assets/images/approved_pass.png" alt="Logo" style="opacity: 0.5" />
                                    </div>
                                </div>
                            </div>

                            <!-- Disapproved Passes -->
                            <div
                                class="panel max-w-md mx-auto bg-gradient-to-r from-blue-500 to-blue-400 p-6 rounded-lg shadow-lg card"
                                onclick="window.location.href='Disapprovedpasses.html'"
                            >
                                <div class="flex">
                                    <!-- Left Column -->
                                    <div class="w-2/3">
                                        <div class="text-md font-semibold text-white">Disapproved Passes</div>
                                        <div class="mt-5 flex items-center">
                                            <div class="text-3xl font-bold text-white ltr:mr-3 rtl:ml-3" id="disapprovedCount">0</div>
                                        </div>
                                        <div class="mt-5 flex items-center font-semibold text-white">
                                            <svg
                                                width="24"
                                                height="24"
                                                viewBox="0 0 24 24"
                                                fill="none"
                                                xmlns="http://www.w3.org/2000/svg"
                                                class="h-5 w-5 shrink-0 ltr:mr-2 rtl:ml-2"
                                            >
                                                <path
                                                    opacity="0.5"
                                                    d="M3.27489 15.2957C2.42496 14.1915 2 13.6394 2 12C2 10.3606 2.42496 9.80853 3.27489 8.70433C4.97196 6.49956 7.81811 4 12 4C16.1819 4 19.028 6.49956 20.7251 8.70433C21.575 9.80853 22 10.3606 22 12C22 13.6394 21.575 14.1915 20.7251 15.2957C19.028 17.5004 16.1819 20 12 20C7.81811 20 4.97196 17.5004 3.27489 15.2957Z"
                                                    stroke="currentColor"
                                                    stroke-width="1.5"
                                                ></path>
                                                <path
                                                    d="M15 12C15 13.6569 13.6569 15 12 15C10.3431 15 9 13.6569 9 12C9 10.3431 10.3431 9 12 9C13.6569 9 15 10.3431 15 12Z"
                                                    stroke="currentColor"
                                                    stroke-width="1.5"
                                                ></path>
                                            </svg>
                                            Last Week <span id="lastWeekCount">0</span>
                                        </div>
                                    </div>
                                    <!-- Right Column -->
                                    <div class="w-1/3 flex items-end justify-end">
                                        <img src="assets/images/disapproved_passes.png" alt="Logo" style="opacity: 0.5" />
                                    </div>
                                </div>
                            </div>

                            <!-- Total Exit Passes -->
                            <div
                                class="panel max-w-md mx-auto bg-gradient-to-r from-fuchsia-500 to-fuchsia-400 p-6 rounded-lg shadow-lg card"
                                onclick="window.location.href='Totalexitpasses.html'"
                            >
                                <div class="flex">
                                    <!-- Left Column -->
                                    <div class="w-2/3">
                                        <div class="text-md font-semibold text-white">Total Exit Passes</div>
                                        <div class="mt-5 flex items-center">
                                            <div class="text-3xl font-bold text-white ltr:mr-3 rtl:ml-3" id="exitCount">0</div>
                                        </div>
                                        <div class="mt-5 flex items-center font-semibold text-white">
                                            <svg
                                                width="24"
                                                height="24"
                                                viewBox="0 0 24 24"
                                                fill="none"
                                                xmlns="http://www.w3.org/2000/svg"
                                                class="h-5 w-5 shrink-0 ltr:mr-2 rtl:ml-2"
                                            >
                                                <path
                                                    opacity="0.5"
                                                    d="M3.27489 15.2957C2.42496 14.1915 2 13.6394 2 12C2 10.3606 2.42496 9.80853 3.27489 8.70433C4.97196 6.49956 7.81811 4 12 4C16.1819 4 19.028 6.49956 20.7251 8.70433C21.575 9.80853 22 10.3606 22 12C22 13.6394 21.575 14.1915 20.7251 15.2957C19.028 17.5004 16.1819 20 12 20C7.81811 20 4.97196 17.5004 3.27489 15.2957Z"
                                                    stroke="currentColor"
                                                    stroke-width="1.5"
                                                ></path>
                                                <path
                                                    d="M15 12C15 13.6569 13.6569 15 12 15C10.3431 15 9 13.6569 9 12C9 10.3431 10.3431 9 12 9C13.6569 9 15 10.3431 15 12Z"
                                                    stroke="currentColor"
                                                    stroke-width="1.5"
                                                ></path>
                                            </svg>
                                            Last Week <span id="lastWeekCount">0</span>
                                        </div>
                                    </div>
                                    <!-- Right Column -->
                                    <div class="w-1/3 flex items-end justify-end">
                                        <img id="img1" src="assets/images/total_exit_passes.png" alt="Logo" style="opacity: 0.5" />
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Existing Tables -->
                        <div class="mb-5 grid grid-cols-1 gap-3 sm:grid-cols-2 xl:grid-cols-2">
                            <!-- ✅ Upcoming Appointments Panel with Working Search -->
                            <div class="panel" x-data="upcomingAppointments" x-init="fetchUpcomingAppointments()">
                                <div class="mb-3 flex items-center justify-between">
                                    <h3 class="text-lg font-bold"><b>Upcoming Appointment</b></h3>
                                    <div class="dataTable-search">
                                        <input class="dataTable-input" placeholder="Search..." type="text" x-model="searchQuery" />
                                    </div>
                                </div>

                                <div class="overflow-x-auto">
                                    <div class="table-container">
                                        <table class="table-hover whitespace-nowrap w-full">
                                            <thead>
                                                <tr>
                                                    <th>First Name</th>
                                                    <th>Last Name</th>
                                                    <th>Date</th>
                                                    <th>Allocated Time</th>
                                                    <th>Host</th>
                                                    <th>Purpose</th>
                                                    <th>National ID</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <!-- If no matches -->
                                                <template x-if="filteredAppointments.length === 0">
                                                    <tr>
                                                        <td colspan="7" class="text-center">No appointments available</td>
                                                    </tr>
                                                </template>

                                                <!-- Render filtered list -->
                                                <template x-for="appointment in filteredAppointments" :key="appointment.id">
                                                    <tr>
                                                        <td x-text="appointment.firstName"></td>
                                                        <td x-text="appointment.lastName"></td>
                                                        <td x-text="appointment.date"></td>
                                                        <td x-text="appointment.allocatedTime"></td>
                                                        <td x-text="appointment.host"></td>
                                                        <td x-text="appointment.purpose"></td>
                                                        <td x-text="appointment.nationalId"></td>
                                                    </tr>
                                                </template>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                            <!-- ✅ Today's Visitor Table Panel with Search -->
                            <div class="panel" x-data="todaysVisitors" x-init="fetchTodaysVisitors()">
                                <div class="mb-3 flex items-center justify-between">
                                    <h3 class="text-lg font-bold"><b>Today's Visitor</b></h3>
                                    <div class="dataTable-search">
                                        <input class="dataTable-input" placeholder="Search..." type="text" x-model="searchQuery" />
                                    </div>
                                </div>

                                <div class="overflow-x-auto">
                                    <div class="table-container">
                                        <table class="table-hover whitespace-nowrap w-full">
                                            <thead>
                                                <tr>
                                                    <th>First Name</th>
                                                    <th>Last Name</th>
                                                    <th>Date</th>
                                                    <th>Allocated Time</th>
                                                    <th>Host</th>
                                                    <th>Purpose</th>
                                                    <th>National ID</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <!-- Show if no results -->
                                                <template x-if="filteredVisitors.length === 0">
                                                    <tr>
                                                        <td colspan="8" class="text-center">No visitors available</td>
                                                    </tr>
                                                </template>

                                                <!-- Loop through filtered list -->
                                                <template x-for="(visitor, index) in filteredVisitors" :key="visitor.id">
                                                    <tr>
                                                        <td x-text="visitor.firstName"></td>
                                                        <td x-text="visitor.lastName"></td>
                                                        <td x-text="visitor.date"></td>
                                                        <td x-text="visitor.allocatedTime"></td>
                                                        <td x-text="visitor.host"></td>
                                                        <td x-text="visitor.purpose"></td>
                                                        <td x-text="visitor.nationalId"></td>
                                                    </tr>
                                                </template>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="mb-5 grid grid-cols-1">
                            <!-- ✅ Visitor Details Table Panel with Search -->
                            <div class="panel" x-data="visitorDetails" x-init="fetchVisitorDetails()">
                                <div class="mb-3 flex items-center justify-between">
                                    <h3 class="text-lg font-bold"><b>Visitor Details</b></h3>
                                    <div class="dataTable-search">
                                        <input class="dataTable-input" placeholder="Search..." type="text" x-model="searchQuery" />
                                    </div>
                                </div>

                                <div class="overflow-x-auto">
                                    <div class="table-container">
                                        <table class="table-hover whitespace-nowrap w-full">
                                            <thead>
                                                <tr>
                                                    <th>First Name</th>
                                                    <th>Last Name</th>
                                                    <th>Date</th>
                                                    <th>Allocated Time</th>
                                                    <th>Host</th>
                                                    <th>Purpose</th>
                                                    <th>National ID</th>
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <!-- If no matches -->
                                                <template x-if="filteredVisitors.length === 0">
                                                    <tr>
                                                        <td colspan="11" class="text-center">No visitors available</td>
                                                    </tr>
                                                </template>

                                                <!-- Filtered Rows -->
                                                <template x-for="(visitor, index) in filteredVisitors" :key="visitor.id">
                                                    <tr>
                                                        <td x-text="visitor.firstName"></td>
                                                        <td x-text="visitor.lastName"></td>
                                                        <td x-text="visitor.date"></td>
                                                        <td x-text="visitor.allocatedTime"></td>
                                                        <td x-text="visitor.host"></td>
                                                        <td x-text="visitor.purpose"></td>
                                                        <td x-text="visitor.nationalId"></td>
                                                        <!-- Progress Steps -->
                                                        <td colspan="4">
                                                            <!-- Use renderProgressSteps to dynamically render the progress steps -->
                                                            <div x-html="renderProgressSteps(visitor)"></div>
                                                        </td>
                                                    </tr>
                                                </template>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- end main content section -->
                </div>

                <!-- start footer section -->
                <div id="footer-container"></div>
                <!-- end footer section -->
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="assets/js/alpine-collaspe.min.js"></script>
        <script src="assets/js/alpine-persist.min.js"></script>
        <script defer src="assets/js/alpine-ui.min.js"></script>
        <script defer src="assets/js/alpine-focus.min.js"></script>
        <script defer src="assets/js/alpine.min.js"></script>
        <script src="assets/js/custom.js"></script>
        <script src="assets/js/main-content-script/index-main-script.js"></script>
        <script src="assets/js/main-content-script/index-login-script.js"></script>
        <script src="assets/js/vms_js/theme-script.js"></script>
        <script src="assets/js/perfect-scrollbar.min.js"></script>
        <script defer src="assets/js/popper.min.js"></script>
        <script defer src="assets/js/tippy-bundle.umd.min.js"></script>
        <script defer src="assets/js/sweetalert.min.js"></script>
        <script src="assets/js/vms_js/header.js"></script>
        <script src="assets/js/auth.js"></script>
        <script src="assets/js/vms_js/scroll-to-topdown.js"></script>
        <script src="assets/js/vms_js/theme-customizer.js"></script>
        <script src="assets/js/vms_js/sidebar-menu-overlay.js"></script>
        <script src="assets/js/vms_js/sidebar.js"></script>
        <script src="assets/js/vms_js/screen-loader.js"></script>
        <script src="assets/js/vms_js/footer.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    </body>
</html>
